{"version":3,"sources":["../../../server/middlewares/verify/verify.js"],"names":["dotenv","config","secret","process","env","SECRET_KEY","verifyAdmin","req","res","next","role","authData","status","json","message","verifyAttendant","authVerify","authorization","headers","error","jwt","verify","err"],"mappings":";;;;;;AAAA;;;;AACA;;;;;;AAEAA,iBAAOC,MAAP;;AAEA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,UAA3B;;AAEA,SAASC,WAAT,CAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AAAA,MAC3BC,IAD2B,GAClBH,IAAII,QADc,CAC3BD,IAD2B;;;AAGnC,MAAIA,SAAS,OAAb,EAAsB;AACpB,WAAOF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,iCAAX,EAArB,CAAP;AACD;;AAED,SAAOL,MAAP;AACD;;AAED,SAASM,eAAT,CAAyBR,GAAzB,EAA8BC,GAA9B,EAAmCC,IAAnC,EAAyC;AAAA,MAC/BC,IAD+B,GACtBH,IAAII,QADkB,CAC/BD,IAD+B;;;AAGvC,MAAIA,SAAS,WAAb,EAA0B;AACxB,WAAOF,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,4CAAX,EAArB,CAAP;AACD;;AAED,SAAOL,MAAP;AACD;;AAED,SAASO,UAAT,CAAoBT,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B,EAAoC;AAAA,MAC1BQ,aAD0B,GACRV,IAAIW,OADI,CAC1BD,aAD0B;;;AAGlC,MAAI,CAACA,aAAL,EAAoB;AAClB,WAAOT,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,eAAS,6BADiB;AAE1BK,aAAO;AAFmB,KAArB,CAAP;AAID;;AAEDC,yBAAIC,MAAJ,CAAWJ,aAAX,EAA0Bf,MAA1B,EAAkC,UAACoB,GAAD,EAAMX,QAAN,EAAmB;AACnD,QAAIW,GAAJ,EAAS;AACP,aAAOd,IAAII,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BC,iBAAS,sCADiB;AAE1BK,eAAO;AAFmB,OAArB,CAAP;AAID;AACDZ,QAAII,QAAJ,GAAeA,QAAf;AACA,WAAOF,MAAP;AACD,GATD;AAUD;;kBAEc,EAAEH,wBAAF,EAAeS,gCAAf,EAAgCC,sBAAhC,E","file":"verify.js","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport dotenv from 'dotenv';\r\n\r\ndotenv.config();\r\n\r\nconst secret = process.env.SECRET_KEY;\r\n\r\nfunction verifyAdmin(req, res, next) {\r\n  const { role } = req.authData;\r\n\r\n  if (role !== 'admin') {\r\n    return res.status(401).json({ message: 'Sorry, accessible to admin only' });\r\n  }\r\n\r\n  return next();\r\n}\r\n\r\nfunction verifyAttendant(req, res, next) {\r\n  const { role } = req.authData;\r\n\r\n  if (role !== 'attendant') {\r\n    return res.status(401).json({ message: 'Sorry, accessible to store attendants only' });\r\n  }\r\n\r\n  return next();\r\n}\r\n\r\nfunction authVerify(req, res, next) {\r\n  const { authorization } = req.headers;\r\n\r\n  if (!authorization) {\r\n    return res.status(401).json({\r\n      message: 'Please, you have to sign in',\r\n      error: true,\r\n    });\r\n  }\r\n\r\n  jwt.verify(authorization, secret, (err, authData) => {\r\n    if (err) {\r\n      return res.status(401).json({\r\n        message: 'You must provide valid authorization',\r\n        error: true,\r\n      });\r\n    }\r\n    req.authData = authData;\r\n    return next();\r\n  });\r\n}\r\n\r\nexport default { verifyAdmin, verifyAttendant, authVerify };\r\n"]}
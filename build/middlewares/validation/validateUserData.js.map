{"version":3,"sources":["../../../server/middlewares/validation/validateUserData.js"],"names":["validateTextField","validationLibrary","ValidateUserData","req","res","next","body","usernameInput","passwordInput","usernameValid","passwordValid","status","json","error","username","password","email","role","emailValid","roleValid"],"mappings":";;;;;;;AAAA;;;;;;;;;;IAEQA,iB,GAAsBC,0B,CAAtBD,iB;;IAEFE,gB;;;;;;;;;kCACiBC,G,EAAKC,G,EAAKC,I,EAAM;AAAA,sBACMF,GAAG,CAACG,IADV;AAAA,UAC3BC,aAD2B,aAC3BA,aAD2B;AAAA,UACZC,aADY,aACZA,aADY;AAGnC,UAAMC,aAAa,GAAGT,iBAAiB,CAAC,eAAD,EAAkBO,aAAlB,EAAiC,CAAjC,EAAoC,EAApC,EAAwC,OAAxC,EAAiD,wBAAjD,CAAvC;AACA,UAAMG,aAAa,GAAGV,iBAAiB,CAAC,eAAD,EAAkBQ,aAAlB,EAAiC,CAAjC,EAAoC,EAApC,EAAwC,0BAAxC,EAAoE,8BAApE,CAAvC;;AAEA,UAAIC,aAAa,KAAK,IAAtB,EAA4B;AAC1BL,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEJ;AAAT,SAArB;AACD,OAFD,MAEO,IAAIC,aAAa,KAAK,IAAtB,EAA4B;AACjCN,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEH;AAAT,SAArB;AACD,OAFM,MAEA;AACLL,QAAAA,IAAI;AACL;AACF;;;mCAEqBF,G,EAAKC,G,EAAKC,I,EAAM;AAAA,uBAGhCF,GAAG,CAACG,IAH4B;AAAA,UAElCQ,QAFkC,cAElCA,QAFkC;AAAA,UAExBC,QAFwB,cAExBA,QAFwB;AAAA,UAEdC,KAFc,cAEdA,KAFc;AAAA,UAEPC,IAFO,cAEPA,IAFO;AAKpC,UAAMR,aAAa,GAAGT,iBAAiB,CAAC,UAAD,EAAac,QAAb,EAAuB,CAAvB,EAA0B,EAA1B,EAA8B,OAA9B,EAAuC,mBAAvC,CAAvC;AACA,UAAMJ,aAAa,GAAGV,iBAAiB,CAAC,UAAD,EAAae,QAAb,EAAuB,CAAvB,EAA0B,EAA1B,EAA8B,0BAA9B,EAA0D,8BAA1D,CAAvC;AACA,UAAMG,UAAU,GAAGlB,iBAAiB,CAAC,OAAD,EAAUgB,KAAV,EAAiB,CAAjB,EAAoB,EAApB,EAAwB,0BAAxB,EAAoD,0CAApD,CAApC;AACA,UAAMG,SAAS,GAAGnB,iBAAiB,CAAC,MAAD,EAASiB,IAAT,EAAe,CAAf,EAAkB,CAAlB,EAAqB,UAArB,EAAiC,kBAAjC,CAAnC;;AAEA,UAAIR,aAAa,KAAK,IAAtB,EAA4B;AAC1BL,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEJ;AAAT,SAArB;AACD,OAFD,MAEO,IAAIC,aAAa,KAAK,IAAtB,EAA4B;AACjCN,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEH;AAAT,SAArB;AACD,OAFM,MAEA,IAAIQ,UAAU,KAAK,IAAnB,EAAyB;AAC9Bd,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEK;AAAT,SAArB;AACD,OAFM,MAEA,IAAIC,SAAS,KAAK,IAAlB,EAAwB;AAC7Bf,QAAAA,GAAG,CAACO,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAEM;AAAT,SAArB;AACD,OAFM,MAEA;AACLd,QAAAA,IAAI;AACL;AACF;;;;;;eAGYH,gB","sourcesContent":["import validationLibrary from './library/validationLibrary';\r\n\r\nconst { validateTextField } = validationLibrary;\r\n\r\nclass ValidateUserData {\r\n  static validateLogin(req, res, next) {\r\n    const { usernameInput, passwordInput } = req.body;\r\n\r\n    const usernameValid = validateTextField('usernameInput', usernameInput, 2, 15, /^\\w+$/, 'john23, doe, 3233_john');\r\n    const passwordValid = validateTextField('passwordInput', passwordInput, 6, 12, /[a-z]?[A-Z]?[0-9]?[$#@]?/, 'asAS997$, asAS997#, asAS997@');\r\n\r\n    if (usernameValid !== true) {\r\n      res.status(422).json({ error: usernameValid });\r\n    } else if (passwordValid !== true) {\r\n      res.status(422).json({ error: passwordValid });\r\n    } else {\r\n      next();\r\n    }\r\n  }\r\n\r\n  static validateSignup(req, res, next) {\r\n    const {\r\n      username, password, email, role,\r\n    } = req.body;\r\n\r\n    const usernameValid = validateTextField('username', username, 2, 15, /^\\w+$/, 'john23, doe, 3233');\r\n    const passwordValid = validateTextField('password', password, 6, 12, /[a-z]+[A-Z]+[0-9]+[$#@]+/, 'asAS997$, asAS997#, asAS997@');\r\n    const emailValid = validateTextField('email', email, 3, 50, /\\w+[-.]*\\w+@\\w+[.][a-z]+/, 'john234.doe@gmail.com, johndoe@gmail.com');\r\n    const roleValid = validateTextField('role', role, 5, 9, /^[a-z]+$/, 'attendant, admin');\r\n\r\n    if (usernameValid !== true) {\r\n      res.status(422).json({ error: usernameValid });\r\n    } else if (passwordValid !== true) {\r\n      res.status(422).json({ error: passwordValid });\r\n    } else if (emailValid !== true) {\r\n      res.status(422).json({ error: emailValid });\r\n    } else if (roleValid !== true) {\r\n      res.status(422).json({ error: roleValid });\r\n    } else {\r\n      next();\r\n    }\r\n  }\r\n}\r\n\r\nexport default ValidateUserData;\r\n"],"file":"validateUserData.js"}